<Window x:Class="MinskTrans.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:minskTrans="clr-namespace:MinskTrans"
        xmlns:modelview="clr-namespace:MinskTrans.Modelview"
        mc:Ignorable="d"
        d:DataContext="{d:DesignInstance modelview:MainModelView}"
        Title="MainWindow" Height="372" Width="961" Loaded="Window_Loaded">
    <Window.Resources>
        <minskTrans:MinsToTimeConverter x:Key="MinsToTimeConverter" />
        <minskTrans:listConverter x:Key="listConverter" />
        <CollectionViewSource x:Key="shedulerModelViewViewSource"
                              d:DesignSource="{d:DesignInstance {x:Type modelview:BaseModelView}, CreateList=True}">
            <CollectionViewSource.GroupDescriptions>
                <PropertyGroupDescription PropertyName="RouteNum" />
            </CollectionViewSource.GroupDescriptions>
        </CollectionViewSource>
        <CollectionViewSource x:Key="shedulerModelViewRoutsViewSource"
                              Source="{Binding Routs, Source={StaticResource shedulerModelViewViewSource}}" />
        <CollectionViewSource x:Key="shedulerModelViewRoutsStopsViewSource"
                              Source="{Binding Stops, Source={StaticResource shedulerModelViewRoutsViewSource}}" />
        <CollectionViewSource x:Key="shedulerModelViewStopsViewSource"
                              Source="{Binding Stops, Source={StaticResource shedulerModelViewViewSource}}" />
        <CollectionViewSource x:Key="shedulerModelViewTimesViewSource"
                              Source="{Binding Times, Source={StaticResource shedulerModelViewViewSource}}" />
        <CollectionViewSource x:Key="shedulerModelViewTimesTimesDictionaryViewSource"
                              Source="{Binding TimesDictionary, Source={StaticResource shedulerModelViewTimesViewSource}}" />
        <CollectionViewSource x:Key="shedulerModelViewRoutViewSource"
                              Source="{Binding Rout, Source={StaticResource shedulerModelViewViewSource}}" />
        <CollectionViewSource x:Key="shedulerModelViewRoutStopsViewSource"
                              Source="{Binding Stops, Source={StaticResource shedulerModelViewViewSource}}" />
        <CollectionViewSource x:Key="shedulerModelViewRouteNamesViewSource"
                              Source="{Binding RouteNames, Source={StaticResource shedulerModelViewViewSource}}" />


    </Window.Resources>
    <TabControl>
        <TabItem Header="Route" DataContext="{Binding RoutesModelview}">
            <Grid>
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto" />
                    <RowDefinition />

                </Grid.RowDefinitions>
                <WrapPanel>
                    <Button Command="{Binding ShowBusCommand}" Content="Bus" Margin="5,0" />
                    <Button Command="{Binding ShowTrolCommand}" Content="Trol" Margin="5,0" />
                    <Button Command="{Binding ShowTramCommand}" Content="Tram" Margin="5,0" />
                    <CheckBox Content="Actual"
                              IsChecked="{Binding CurTime, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                              Margin="5,0" />
                    <TextBlock Text="{Binding TypeTransport}" Margin="5,0,0,0" />
                </WrapPanel>
                <DockPanel Grid.Row="1">
                    <DockPanel>
                        <TextBox DockPanel.Dock="Top" HorizontalAlignment="Left" Height="23" TextWrapping="Wrap"
                                 Text="{Binding RoutNum, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                 VerticalAlignment="Top" Width="83" Margin="0" />

                        <ListView ItemsSource="{Binding RouteNums, UpdateSourceTrigger=PropertyChanged}"
                                  SelectedValue="{Binding RouteNumSelectedValue, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                  Margin="0" SelectedIndex="0" RenderTransformOrigin="0.5,0.5">

                            <ListView.GroupStyle>
                                <GroupStyle>
                                    <GroupStyle.ContainerStyle>
                                        <Style TargetType="{x:Type GroupItem}">
                                            <Setter Property="Template">
                                                <Setter.Value>
                                                    <ControlTemplate>
                                                        <GroupBox Margin="10" Header="{Binding Key}">
                                                            <GroupBox.Content>
                                                                <ContentPresenter />
                                                            </GroupBox.Content>
                                                        </GroupBox>
                                                    </ControlTemplate>
                                                </Setter.Value>
                                            </Setter>
                                        </Style>
                                    </GroupStyle.ContainerStyle>
                                </GroupStyle>
                            </ListView.GroupStyle>
                        </ListView>
                    </DockPanel>
                    <Grid>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="0.3*" />
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="0.7*" />
                        </Grid.RowDefinitions>
                        <ListView DockPanel.Dock="Top" ItemsSource="{Binding RouteNames}"
                                  SelectedValue="{Binding RouteSelectedValue, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                  DisplayMemberPath="RouteName" Margin="0" SelectedIndex="0" MinWidth="250"
                                  MinHeight="100" />
                        <GridSplitter Grid.Row="1" HorizontalAlignment="Stretch" Height="5" />
                        <ListView Grid.Row="2" ItemsSource="{Binding  StopsObservableCollection}"
                                  SelectedIndex="{Binding StopSelectedIndex}" DisplayMemberPath="Name" Margin="0"
                                  DockPanel.Dock="Bottom" />
                    </Grid>

                    <ListView DockPanel.Dock="Left"
                              ItemsSource="{Binding TimesObservableCollection, UpdateSourceTrigger=PropertyChanged}"
                              Margin="0">
                        <ListView.ItemsPanel>
                            <ItemsPanelTemplate>
                                <WrapPanel IsItemsHost="True" />
                            </ItemsPanelTemplate>
                        </ListView.ItemsPanel>
                        <ListView.ItemTemplate>
                            <DataTemplate>
                                <Grid>
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="Auto" />
                                        <RowDefinition />
                                    </Grid.RowDefinitions>
                                    <TextBlock Text="{Binding Days}" />
                                    <minskTrans:ScheduleView Grid.Row="1" HorizontalAlignment="Stretch"
                                                             Margin="0,0,0,0" VerticalAlignment="Stretch" Height="Auto"
                                                             Width="Auto" DataContext="{Binding}" />
                                </Grid>
                            </DataTemplate>
                        </ListView.ItemTemplate>
                    </ListView>
                </DockPanel>

            </Grid>
        </TabItem>
        <TabItem Header="Stops" DataContext="{Binding StopMovelView }">
            <Grid>
                <ListView x:Name="ListView"
                          SelectedValue="{Binding FilteredSelectedStop, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                          ItemsSource="{Binding FilteredStops}" DisplayMemberPath="Name" HorizontalAlignment="Left"
                          Height="226" Margin="67,47,0,0" VerticalAlignment="Top" Width="249" />
                <DataGrid ItemsSource="{Binding TimeSchedule, UpdateSourceTrigger=PropertyChanged}"
                          AutoGenerateColumns="False" HorizontalAlignment="Left" Height="217" Margin="341,47,0,0"
                          VerticalAlignment="Top" Width="363">
                    <DataGrid.Columns>
                        <DataGridTextColumn Binding="{Binding Key}" />
                        <DataGridTextColumn
                            Binding="{Binding Value, ConverterParameter=Value, Converter={StaticResource MinsToTimeConverter}, Mode=OneWay}" />
                        <DataGridTextColumn Binding="{Binding Key.Transport}" />
                    </DataGrid.Columns>
                </DataGrid>
                <TextBox HorizontalAlignment="Left" Height="23" Margin="88,20,0,0" TextWrapping="Wrap"
                         Text="{Binding StopNameFilter, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                         VerticalAlignment="Top" Width="120" />
                <TextBox HorizontalAlignment="Left" Height="23" Margin="248,20,0,0" TextWrapping="Wrap"
                         Text="{Binding NowTimeHour, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                         VerticalAlignment="Top" Width="120" />
                <TextBox HorizontalAlignment="Left" Height="23" Margin="373,19,0,0" TextWrapping="Wrap"
                         Text="{Binding NowTimeMin, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                         VerticalAlignment="Top" Width="120" />
                <CheckBox Content="AutoDay"
                          IsChecked="{Binding AutoDay, Mode=TwoWay,UpdateSourceTrigger=PropertyChanged}"
                          HorizontalAlignment="Left" Margin="245,7,0,0" VerticalAlignment="Top"
                          RenderTransformOrigin="0.521,0.467" />
                <CheckBox Content="AutoNowTime"
                          IsChecked="{Binding AutoNowTime, Mode=TwoWay,UpdateSourceTrigger=PropertyChanged}"
                          HorizontalAlignment="Left" Margin="341,7,0,0" VerticalAlignment="Top"
                          RenderTransformOrigin="0.521,0.467" />
                <TextBox HorizontalAlignment="Left" Height="23" Margin="498,19,0,0" TextWrapping="Wrap"
                         Text="{Binding CurDay, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                         VerticalAlignment="Top" Width="120" />
                <Button Content="Button" HorizontalAlignment="Left" Margin="865,176,0,0" VerticalAlignment="Top"
                        Width="75" Click="Button_Click_1" />
            </Grid>
        </TabItem>
        <TabItem Header="Stops">
            <DockPanel>
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition />
                        <RowDefinition />
                    </Grid.RowDefinitions>
                    <TextBox x:Name="text1" HorizontalAlignment="Left" Height="23" Margin="60,54,0,0"
                             TextWrapping="Wrap" Text="ACEABPCQDEABCR" VerticalAlignment="Top" Width="120" />
                    <TextBox x:Name="text2" HorizontalAlignment="Left" Height="23" Margin="60,82,0,0"
                             TextWrapping="Wrap" Text="ABCDE " VerticalAlignment="Top" Width="120" />
                    <Button Content="Button" HorizontalAlignment="Left" Margin="242,65,0,0" VerticalAlignment="Top"
                            Width="75" Click="Button_Click" />
                    <DataGrid x:Name="DataGrid" HorizontalAlignment="Left" Margin="370,23,0,0" VerticalAlignment="Top"
                              Height="113" Width="180" />
                    <TextBox x:Name="result" HorizontalAlignment="Left" Height="176" Margin="609,48,0,0"
                             TextWrapping="Wrap" Text="TextBox" VerticalAlignment="Top" Width="296" Grid.RowSpan="2" />
                </Grid>
            </DockPanel>
        </TabItem>
        <TabItem Header="Routs">
            <DockPanel>
                <Button Content="ParsStops" DockPanel.Dock="Bottom" Command="{Binding ParseRoutsCommand}"
                        CommandParameter="{Binding Text, ElementName=textBox1, UpdateSourceTrigger=PropertyChanged}" />
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition />
                        <RowDefinition Height="Auto" />
                        <RowDefinition />
                    </Grid.RowDefinitions>

                    <TextBox Grid.Row="2" x:Name="textBox1" DockPanel.Dock="Bottom" AcceptsReturn="True"
                             AcceptsTab="True" />
                    <GridSplitter Grid.Row="1" Height="5" />
                    <DataGrid Grid.Row="0" DockPanel.Dock="Top"
                              ItemsSource="{Binding Routs, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" />
                </Grid>
            </DockPanel>
        </TabItem>
        <TabItem Header="Times">
            <DockPanel>
                <Button Content="ParsStops" DockPanel.Dock="Bottom" Command="{Binding ParseTimesCommand}"
                        CommandParameter="{Binding Text, ElementName=textBox2, UpdateSourceTrigger=PropertyChanged}" />
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition />
                        <RowDefinition Height="Auto" />
                        <RowDefinition />
                    </Grid.RowDefinitions>
                    <TextBox Grid.Row="2" x:Name="textBox2" DockPanel.Dock="Bottom" AcceptsReturn="True"
                             AcceptsTab="True" />
                    <GridSplitter Grid.Row="1" Grid.RowSpan="2" />
                    <DataGrid Grid.Row="0" DockPanel.Dock="Top"
                              ItemsSource="{Binding  Times, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}">
                        <DataGrid.RowDetailsTemplate>
                            <DataTemplate>
                                <DataGrid ItemsSource="{Binding TimesDictionary}">
                                    <DataGrid.RowDetailsTemplate>
                                        <DataTemplate>

                                            <ListView ItemsSource="{Binding Value}" />

                                        </DataTemplate>
                                    </DataGrid.RowDetailsTemplate>
                                </DataGrid>
                            </DataTemplate>
                        </DataGrid.RowDetailsTemplate>
                    </DataGrid>
                </Grid>
            </DockPanel>
        </TabItem>
        <TabItem>
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition />
                    <ColumnDefinition />
                </Grid.ColumnDefinitions>
                <Grid.RowDefinitions>
                    <RowDefinition />
                    <RowDefinition />
                </Grid.RowDefinitions>
                <DataGrid x:Name="routsDataGrid" AutoGenerateColumns="False" EnableRowVirtualization="True"
                          ItemsSource="{Binding}" Margin="0" RowDetailsVisibilityMode="VisibleWhenSelected">
                    <DataGrid.Columns>
                        <DataGridTextColumn x:Name="authorityColumn" Binding="{Binding Authority}" Header="Authority"
                                            Width="SizeToHeader" />
                        <DataGridTextColumn x:Name="cityColumn" Binding="{Binding City}" Header="City"
                                            Width="SizeToHeader" />
                        <DataGridTextColumn x:Name="commercialColumn" Binding="{Binding Commercial}"
                                            Header="Commercial" Width="SizeToHeader" />
                        <DataGridTextColumn x:Name="dataColumn" Binding="{Binding Data}" Header="Data"
                                            Width="SizeToHeader" />
                        <DataGridTextColumn x:Name="datestartColumn" Binding="{Binding Datestart}" Header="Datestart"
                                            Width="SizeToHeader" />
                        <DataGridTextColumn x:Name="entryColumn" Binding="{Binding Entry}" Header="Entry"
                                            Width="SizeToHeader" />
                        <DataGridTextColumn x:Name="operatorColumn" Binding="{Binding Operator}" Header="Operator"
                                            Width="SizeToHeader" />
                        <DataGridTextColumn x:Name="routeNameColumn" Binding="{Binding RouteName}" Header="Route Name"
                                            Width="SizeToHeader" />
                        <DataGridTextColumn x:Name="routeNumColumn" Binding="{Binding RouteNum}" Header="Route Num"
                                            Width="SizeToHeader" />
                        <DataGridTextColumn x:Name="routIdColumn" Binding="{Binding RoutId}" Header="Rout Id"
                                            Width="SizeToHeader" />
                        <DataGridTextColumn x:Name="routTagColumn" Binding="{Binding RoutTag}" Header="Rout Tag"
                                            Width="SizeToHeader" />
                        <DataGridTextColumn x:Name="routTypeColumn" Binding="{Binding RoutType}" Header="Rout Type"
                                            Width="SizeToHeader" />
                        <DataGridTextColumn x:Name="specialDatesColumn" Binding="{Binding SpecialDates}"
                                            Header="Special Dates" Width="SizeToHeader" />
                        <DataGridTemplateColumn x:Name="timeColumn" Header="Time" Width="SizeToHeader">
                            <DataGridTemplateColumn.CellTemplate>
                                <DataTemplate>
                                    <DataGrid DisplayMemberPath="Time" ItemsSource="{Binding}" />
                                </DataTemplate>
                            </DataGridTemplateColumn.CellTemplate>
                        </DataGridTemplateColumn>
                        <DataGridTextColumn x:Name="transportColumn" Binding="{Binding Transport}" Header="Transport"
                                            Width="SizeToHeader" />
                        <DataGridTextColumn x:Name="validityPeriodsColumn" Binding="{Binding ValidityPeriods}"
                                            Header="Validity Periods" Width="SizeToHeader" />
                        <DataGridTextColumn x:Name="weekdaysColumn" Binding="{Binding Weekdays}" Header="Weekdays"
                                            Width="SizeToHeader" />
                    </DataGrid.Columns>
                </DataGrid>
                <DataGrid x:Name="timeDataGrid" Grid.Column="1" DisplayMemberPath="Time"
                          ItemsSource="{Binding Source={StaticResource shedulerModelViewRoutsViewSource}}" Margin="0" />
                <DataGrid x:Name="stopsDataGrid" AutoGenerateColumns="False" EnableRowVirtualization="True"
                          ItemsSource="{Binding Source={StaticResource shedulerModelViewRoutsStopsViewSource}}"
                          Margin="0" Grid.Row="1" RowDetailsVisibilityMode="VisibleWhenSelected">
                    <DataGrid.Columns>
                        <DataGridTextColumn x:Name="areaColumn" Binding="{Binding Area}" Header="Area"
                                            Width="SizeToHeader" />
                        <DataGridTextColumn x:Name="cityColumn1" Binding="{Binding City}" Header="City"
                                            Width="SizeToHeader" />
                        <DataGridTextColumn x:Name="iDColumn" Binding="{Binding ID}" Header="ID" Width="SizeToHeader" />
                        <DataGridTextColumn x:Name="infoColumn" Binding="{Binding Info}" Header="Info"
                                            Width="SizeToHeader" />
                        <DataGridTextColumn x:Name="latColumn" Binding="{Binding Lat}" Header="Lat"
                                            Width="SizeToHeader" />
                        <DataGridTextColumn x:Name="lngColumn" Binding="{Binding Lng}" Header="Lng"
                                            Width="SizeToHeader" />
                        <DataGridTextColumn x:Name="nameColumn" Binding="{Binding Name}" Header="Name"
                                            Width="SizeToHeader" />
                        <DataGridTextColumn x:Name="stopNumColumn" Binding="{Binding StopNum}" Header="Stop Num"
                                            Width="SizeToHeader" />
                        <DataGridTextColumn x:Name="stopsStrColumn" Binding="{Binding StopsStr}" Header="Stops Str"
                                            Width="SizeToHeader" />
                        <DataGridTextColumn x:Name="streatColumn" Binding="{Binding Streat}" Header="Streat"
                                            Width="SizeToHeader" />
                    </DataGrid.Columns>
                </DataGrid>


            </Grid>
        </TabItem>

    </TabControl>
</Window>