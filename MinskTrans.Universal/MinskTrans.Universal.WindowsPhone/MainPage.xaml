<Page xmlns:Controls="using:NumberConverter.WinRTXamlToolkit.Controls"
	xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
	xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
	xmlns:local="using:MinskTrans.Universal"
	xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
	xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
	xmlns:modelview="using:MinskTrans.DesctopClient.Modelview"
	xmlns:Converters="using:MinskTrans.Universal.Converters" 
	x:Class="MinskTrans.Universal.MainPage"
	mc:Ignorable="d"
	d:DataContext="{d:DesignInstance modelview:MainModelView}"
	Background="{ThemeResource ApplicationPageBackgroundThemeBrush}" Loaded="Page_Loaded">
	<Page.Resources>
		<Converters:RoutsToNumStrConverter x:Key="RoutsToNumStrConverter"/>
		<Converters:StopsToStr x:Key="StopsToStr"/>
		<Converters:TransportToImageConverter x:Key="TransportToImageConverter"/>
		<local:MinsLeftConverter x:Key="MinsLeftConverter"/>
		<local:MinsToTimeConverter x:Key="MinsToTimeConverter"/>
		<DataTemplate x:Key="ListStopsDataTemplate">
			<Grid>
				<Grid.RowDefinitions>
					<RowDefinition Height="Auto"/>
					<RowDefinition Height="Auto"/>
					<RowDefinition Height="Auto"/>
				</Grid.RowDefinitions>
				<Grid.ColumnDefinitions>
					<ColumnDefinition Width="Auto"/>
					<ColumnDefinition/>
					<ColumnDefinition/>
					<ColumnDefinition/>
				</Grid.ColumnDefinitions>
				<TextBlock Grid.ColumnSpan="10" 
						   Text="{Binding Name}"/>
				<TextBlock Grid.ColumnSpan="10" 
						   Grid.Row="1"
						   TextWrapping="WrapWholeWords"
						   Text="{Binding DirectionsString, Converter={StaticResource StopsToStr}}"
						   MaxLines="2"/>
				<Controls:WrapPanel Grid.Row="2" Grid.ColumnSpan="9">
				<Grid HorizontalAlignment="Left" >
					<Grid.ColumnDefinitions>
						<ColumnDefinition Width="Auto"/>
						<ColumnDefinition Width="Auto"/>
					</Grid.ColumnDefinitions>
					<Image Source="Image/trol.jpg"
						   Height="{Binding ElementName=TextBlock, Path=ActualHeight, UpdateSourceTrigger=PropertyChanged}"
					   Grid.Column="0"/>
					<TextBlock Name="TextBlock"
						Grid.Column="1"
						   Text="{Binding TrolRoutsNum, Converter={StaticResource RoutsToNumStrConverter}}"/>
				</Grid>
					<Grid HorizontalAlignment="Left" >
						<Grid.ColumnDefinitions>
							<ColumnDefinition Width="Auto"/>
							<ColumnDefinition Width="Auto"/>
						</Grid.ColumnDefinitions>
						<Image Source="Image/bus.jpg"
						   Height="{Binding ElementName=TextBlock1, Path=ActualHeight, UpdateSourceTrigger=PropertyChanged}"
					   Grid.Column="0"/>
						<TextBlock Name="TextBlock1"
						Grid.Column="1"
						   Text="{Binding BusRoutsNum, Converter={StaticResource RoutsToNumStrConverter}}"/>
					</Grid>
					<Grid HorizontalAlignment="Left" >
						<Grid.ColumnDefinitions>
							<ColumnDefinition Width="Auto"/>
							<ColumnDefinition Width="Auto"/>
						</Grid.ColumnDefinitions>
						<Image Source="Image/tram.jpg"
						   Height="{Binding ElementName=TextBlock2, Path=ActualHeight, UpdateSourceTrigger=PropertyChanged}"
					   Grid.Column="0"/>
						<TextBlock Name="TextBlock2"
						Grid.Column="1"
						   Text="{Binding TramRoutsNum, Converter={StaticResource RoutsToNumStrConverter}}"/>
					</Grid>
				</Controls:WrapPanel>

			</Grid>
		</DataTemplate>
		
	</Page.Resources>

	<Pivot >
		<PivotItem Header="Избранное" >
			<Grid>
				<Grid.ColumnDefinitions>
					<ColumnDefinition/>
					<ColumnDefinition/>
				</Grid.ColumnDefinitions>
				<Grid.RowDefinitions>
					<RowDefinition Height="Auto"/>
					<RowDefinition/>
				</Grid.RowDefinitions>
				<HyperlinkButton Content="Остановки!"></HyperlinkButton>
				<HyperlinkButton Grid.Column="1"
								 Content="Транспорт!"/>
				
				<ListView ItemsSource="{Binding  Context.FavouriteStops}"
						  DataContext="{Binding  GroupStopsModelView}"
						  SelectedItem="{Binding FilteredSelectedStop, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
					Grid.Row="1"
						  Grid.ColumnSpan="2" ItemTemplate="{StaticResource ListStopsDataTemplate}" SelectionChanged="ListView_ItemClick"></ListView>

                <local:ShowStopView x:Name="ShowFavouriteStop" 
					  DataContext="{Binding GroupStopsModelView}"
					  Visibility="Collapsed"
					  Grid.Row="1"
					  Grid.Column="0"
					  Grid.ColumnSpan="2">
                </local:ShowStopView>
			</Grid>
		</PivotItem>

		<PivotItem Header="Поиск" DataContext="{Binding FindModelView}" >
			<Grid>
				<Grid.ColumnDefinitions>
					<ColumnDefinition/>
					<ColumnDefinition/>
				</Grid.ColumnDefinitions>
				<Grid.RowDefinitions>
					<RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>

                    <RowDefinition/>
				</Grid.RowDefinitions>
				<HyperlinkButton Content="Остановки!"></HyperlinkButton>
				<HyperlinkButton Grid.Column="1"
								 Content="Транспорт!"/>
                <TextBox x:Name="FindStop" 
                         Text="{Binding StopModelView.StopNameFilter, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"/>

                <TextBox x:Name="FindTrans" 
                         Visibility="Collapsed"
                         Text="{Binding RoutesModelview.RoutNum, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"/>

                <ListView x:Name="StopsListView"
                    ItemsSource="{Binding  Context.ActualStops}"
						  DataContext="{Binding  StopModelView}"
						  SelectedItem="{Binding FilteredSelectedStop, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
					Grid.Row="1"
						  Grid.ColumnSpan="2" ItemTemplate="{StaticResource ListStopsDataTemplate}" SelectionChanged="ListView_ShowStop_ItemClick"></ListView>

                <local:ShowStopView x:Name="ShowStop" 
					  DataContext="{Binding GroupStopsModelView}"
					  Visibility="Collapsed"
					  Grid.Row="1"
					  Grid.Column="0"
					  Grid.ColumnSpan="2">
                </local:ShowStopView>
			</Grid>
		</PivotItem>
		<!--<PivotItem Header="Избранное">
			<Grid>


			</Grid>
		</PivotItem>-->
		<PivotItem Header="Debug">
			<Grid Loaded="Grid_Loaded">
				<Button Content="Button" HorizontalAlignment="Left" Margin="98,72,0,0" VerticalAlignment="Top" Click="Button_Click"/>
				<Button Content="Button" HorizontalAlignment="Left" Margin="98,128,0,0" VerticalAlignment="Top" Click="Button_Click_1"/>
				<ListBox x:Name="listBox" HorizontalAlignment="Left" Height="134" Margin="10,228,0,0" VerticalAlignment="Top" Width="380"/>
				<Button Content="Button" HorizontalAlignment="Left" Margin="252,176,0,0" VerticalAlignment="Top" Click="Button_Click_2"/>
				<ListBox x:Name="listview" ItemsSource="{Binding Context.Routs, UpdateSourceTrigger=PropertyChanged}"
					DisplayMemberPath="RouteName"
					HorizontalAlignment="Left" Height="263" Margin="10,367,0,0" VerticalAlignment="Top" Width="380"/>

			</Grid>
		</PivotItem>
	</Pivot>
</Page>